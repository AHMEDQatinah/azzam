var cbl=cbl||{};cbl.API={featuredArticleContainer:$("#featuredArticleContainer"),articleHeading:$("#articleHeading"),mainContainer:$("#mainContainer"),articleContainer:$("#articleContainer"),articleTemplate:$("#articleTemplate"),featuredArticleTemplate:$("#featuredArticleTemplate"),loadMoreContainer:$("#loadMoreContainer"),loadMorebtn:$("#loadMorebtn"),articles:[],getContentHubListing:function(){$("#mainContainer").addClass("loading");var n="";$(".category-item.current").data("id")!=undefined&&(n=$(".category-item.current").data("id"));$.ajax({url:"/api/GetContentHubListing?dataSourceId="+$("#contentHubSourceId").val()+"&categoryId="+n+"&pageNumber="+cbl.API.loadMorebtn.data("pageno")+"&pageSize="+cbl.API.loadMorebtn.data("pagesize")+"&culture="+$("html").attr("lang"),method:"GET",success:function(n){var i,r,t,u,f,e;if(n&&n.Success)if(cbl.API.articleHeading.show(),cbl.API.mainContainer.show(),cbl.API.loadMoreContainer.show(),cbl.API.featuredArticleContainer.show(),n.FeaturedContent!=null?(cbl.API.featuredArticleContainer.html(""),i=cbl.API.featuredArticleTemplate.html(),r=Mustache.to_html(i,n.FeaturedContent),cbl.API.featuredArticleContainer.html(r),$("#contentHubListingComponent .tab-content").show(),$("#contentHubListingComponent .tab-content .tab-pane").show()):(cbl.API.featuredArticleContainer.html(""),cbl.API.featuredArticleContainer.hide()),n.Articles.length>0){for(t=0;t<n.Articles.length;t++)cbl.API.articles.push(n.Articles[t]);u=cbl.API.articleTemplate.html();f=Mustache.to_html(u,cbl.API.articles);cbl.API.articleContainer.html(f);n.hasNextPage?(e=parseInt(cbl.API.loadMorebtn.data("pageno")),cbl.API.loadMorebtn.data("pageno",e+1)):cbl.API.loadMoreContainer.hide()}else cbl.API.articleHeading.hide(),cbl.API.mainContainer.hide(),cbl.API.loadMoreContainer.hide();else cbl.API.noResultFound();$("#mainContainer").removeClass("loading")},error:function(){console.log("error in content hub listing js");$("#mainContainer").removeClass("loading")}})},noResultFound:function(){cbl.API.articleHeading.hide();cbl.API.mainContainer.hide();cbl.API.loadMoreContainer.hide();cbl.API.featuredArticleContainer.hide()},categoryClickEvent:function(){$(document).on("click",".category-item",function(){cbl.API.loadMorebtn.data("pageno",1);$(".category-item").removeClass("current");$(this).addClass("current");cbl.API.articles=[];cbl.API.articleContainer.html("");cbl.API.getContentHubListing()})},loadMoreClickEvent:function(){$(document).on("click","#loadMorebtn",function(){cbl.API.getContentHubListing()})},init:function(){this.categoryClickEvent();this.loadMoreClickEvent();this.getContentHubListing()}};$(document).ready(function(){$("#contentHubListingComponent").length>0&&cbl.API.init()});